id: 9baacc04-1011-47fa-821c-ac8b1842e968
version: 4
vcShouldKeepItemLegacyProdMachine: false
name: PAN-OS Network Operations - Configuration Issue Remediation
description: Remediates configuration issues identified by the Device Management integration.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: cf97b70d-5d2c-4007-83cd-2db73b9d487c
    type: start
    task:
      id: cf97b70d-5d2c-4007-83cd-2db73b9d487c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 7f1bb77b-9b36-446e-88ab-5a7664facf95
    type: regular
    task:
      id: 7f1bb77b-9b36-446e-88ab-5a7664facf95
      version: -1
      name: Get Indicators By the query
      description: Returns indicator custom fields into the context by the given query.
      scriptName: GetIndicatorFieldsByQuery
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      query:
        simple: ${inputs.issue_query} expirationStatus:active issuestatus:unresolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 3055ebc1-4072-4da7-81bb-74bed884a59c
    type: regular
    task:
      id: 3055ebc1-4072-4da7-81bb-74bed884a59c
      version: -1
      name: Associate Indicators to this Incident
      description: commands.local.cmd.associate.indicator
      script: Builtin|||associateIndicatorToIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
      - "22"
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      value:
        simple: ${GetIndicatorFieldsByQuery.value}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: c1440137-c5a0-4fa6-8c02-e7731753b65e
    type: title
    task:
      id: c1440137-c5a0-4fa6-8c02-e7731753b65e
      version: -1
      name: Visibility
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
      - "31"
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 1f3d9b42-5dd8-443d-8680-1c74d5ff0613
    type: title
    task:
      id: 1f3d9b42-5dd8-443d-8680-1c74d5ff0613
      version: -1
      name: BP-V-8
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 4a0a6c2e-4911-456d-87bb-e0c9967d1b4b
    type: condition
    task:
      id: 4a0a6c2e-4911-456d-87bb-e0c9967d1b4b
      version: -1
      name: Do we have BP-V-8 issues?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GetIndicatorFieldsByQuery.issueid
            iscontext: true
          right:
            value:
              simple: BP-V-8
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 1225df01-0e2c-45bb-81ce-3501b91e2d60
    type: regular
    task:
      id: 1225df01-0e2c-45bb-81ce-3501b91e2d60
      version: -1
      name: Group
      description: Groups configuration issues into actionable items so they can be
        passed into the `pan-os-config-bulk-update` command.
      scriptName: GroupIssuesByFields
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      extend-context:
        simple: bpv8fixes=.
      indicator_fields_by_query:
        complex:
          root: GetIndicatorFieldsByQuery
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GetIndicatorFieldsByQuery.issueid
                iscontext: true
              right:
                value:
                  simple: BP-V-8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 0dcc98cf-7de0-4450-8a78-7cde30c0248a
    type: playbook
    task:
      id: 0dcc98cf-7de0-4450-8a78-7cde30c0248a
      version: -1
      name: PAN-OS Network Operation - Run Bulk Change
      description: This playbook runs the fixes identified by GroupIssuesByFields
        as a looped playbook to ensure the correct objects are updated at all times.
      playbookName: PAN-OS Network Operations - Run Bulk Change
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      attribute_to_update:
        simple: log_end
      issue_to_fix:
        simple: ${bpv8fixes}
      new_value:
        simple: "true"
      object_type:
        simple: SecurityRule
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
      forEach: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: a2be60a0-3430-471d-865a-966f6367bacd
    type: title
    task:
      id: a2be60a0-3430-471d-865a-966f6367bacd
      version: -1
      name: Commit
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 333bc30a-30d8-4109-8f8e-fc1a46ae5b54
    type: playbook
    task:
      id: 333bc30a-30d8-4109-8f8e-fc1a46ae5b54
      version: -1
      name: PAN-OS Commit Configuration
      description: Commit the PAN-OS Panorama or Firewall configuration.\nIf specified
        as Panorama, it also pushes the Policies to the specified Device Group in
        the instance.
      playbookName: PAN-OS Commit Configuration
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 74d04b7f-341f-4ddc-84c3-b8e2d89d0f8f
    type: condition
    task:
      id: 74d04b7f-341f-4ddc-84c3-b8e2d89d0f8f
      version: -1
      name: Automatically commit the fixes?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: incident.autocommit
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 386547cd-a609-4e8e-86e9-fbe18c9f818a
    type: regular
    task:
      id: 386547cd-a609-4e8e-86e9-fbe18c9f818a
      version: -1
      name: Mark Complete to Commit the changes
      description: 'Mark this task complete to commit the changes made to Panorama
        and push them to the device groups. '
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 7f8b5a01-97f4-4afd-8333-447dfe4480c7
    type: regular
    task:
      id: 7f8b5a01-97f4-4afd-8333-447dfe4480c7
      version: -1
      name: Close the remediation
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 05e4a3ee-5dc3-4dfb-86cd-824b95e07e1b
    type: condition
    task:
      id: 05e4a3ee-5dc3-4dfb-86cd-824b95e07e1b
      version: -1
      name: Do we have BP-V-9 issues?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GetIndicatorFieldsByQuery.issueid
            iscontext: true
          right:
            value:
              simple: BP-V-9
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: b469f8a5-fcbf-4329-8307-6679a60d7153
    type: regular
    task:
      id: b469f8a5-fcbf-4329-8307-6679a60d7153
      version: -1
      name: Group
      description: Groups configuration issues into actionable items so they can be
        passed into the `pan-os-config-bulk-update` command.
      scriptName: GroupIssuesByFields
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      extend-context:
        simple: bpv9fixes=.
      indicator_fields_by_query:
        complex:
          root: GetIndicatorFieldsByQuery
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GetIndicatorFieldsByQuery.issueid
                iscontext: true
              right:
                value:
                  simple: BP-V-9
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: b719d918-f762-44ec-8ddb-48894b3ad5a9
    type: playbook
    task:
      id: b719d918-f762-44ec-8ddb-48894b3ad5a9
      version: -1
      name: PAN-OS Network Operation - Run Bulk Change
      description: This playbook runs the fixes identified by GroupIssuesByFields
        as a looped playbook to ensure the correct objects are updated at all times.
      playbookName: PAN-OS Network Operations - Run Bulk Change
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      attribute_to_update:
        simple: log_setting
      issue_to_fix:
        simple: ${bpv9fixes}
      new_value:
        simple: ${inputs.default_log_forwarding_profile}
      object_type:
        simple: SecurityRule
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
      forEach: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 9c8f5d7f-dfa2-4bc9-876b-cd6845fe1916
    type: regular
    task:
      id: 9c8f5d7f-dfa2-4bc9-876b-cd6845fe1916
      version: -1
      name: Set the indicator as Resolved
      description: commands.local.cmd.set.indicator
      script: Builtin|||setIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      issuestatus:
        simple: resolved
      value:
        simple: ${GetIndicatorFieldsByQuery.value}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 2c87d773-dcef-46d7-8f4e-8ef5feb32280
    type: regular
    task:
      id: 2c87d773-dcef-46d7-8f4e-8ef5feb32280
      version: -1
      name: Get Log Forwarding Profiles
      description: Searches and returns a reference for the given object type and
        name. If no name is provided, all objects of the given type will be returned.
        Note this ONLY returns the object name and its location in the configuration
        hierachy, not the entire object.
      script: '|||pan-os-config-get-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      device_filter_string:
        simple: ${GetIndicatorFieldsByQuery.issueaffecteddevice}
      object_type:
        simple: LogForwardingProfile
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 528bb739-bce2-495c-8b6b-528252fe1454
    type: condition
    task:
      id: 528bb739-bce2-495c-8b6b-528252fe1454
      version: -1
      name: Do we have a default log forwarding profile?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "19"
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.default_log_forwarding_profile
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: d61600cc-7a49-4379-8807-e88c9449748e
    type: collection
    task:
      id: d61600cc-7a49-4379-8807-e88c9449748e
      version: -1
      name: Select the log Forwarding profile to use.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body: null
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          complex:
            root: PANOS.PanosObject
            accessor: name
            transformers:
            - operator: concat
              args:
                prefix:
                  value:
                    simple: |+
                      #### Set the default log forwarding profile.

                      *The Log Forwarding profiles configured in Panorama are listed below*



                suffix: {}
            - operator: join
              args:
                separator:
                  value:
                    simple: ', '
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: defaultlogforwardingprofile
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Log Forwarding Profile Selection
      description: |-
        To rectify BP-V-9 issues - missing log forwarding setting - you must choose which log forwarding profile to set.

        **A default  value can be provided in the playbook inputs to avoid this question in the future.**
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 4d54a966-d011-48ed-80b5-6a4a343efa08
    type: title
    task:
      id: 4d54a966-d011-48ed-80b5-6a4a343efa08
      version: -1
      name: Threat
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": 500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 96cff264-eb86-4f72-8ee6-1c88748f8701
    type: title
    task:
      id: 96cff264-eb86-4f72-8ee6-1c88748f8701
      version: -1
      name: BP-V-10
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: b98bdfcc-72cc-4d2a-8550-eed76209235a
    type: condition
    task:
      id: b98bdfcc-72cc-4d2a-8550-eed76209235a
      version: -1
      name: Do we have BP-V-10 issues?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GetIndicatorFieldsByQuery.issueid
            iscontext: true
          right:
            value:
              simple: BP-V-10
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": 780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: f0873b83-138a-4762-87f9-8fedb7da548d
    type: regular
    task:
      id: f0873b83-138a-4762-87f9-8fedb7da548d
      version: -1
      name: Group
      description: Groups configuration issues into actionable items so they can be
        passed into the `pan-os-config-bulk-update` command.
      scriptName: GroupIssuesByFields
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      extend-context:
        simple: bpv10fixes=.
      indicator_fields_by_query:
        complex:
          root: GetIndicatorFieldsByQuery
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GetIndicatorFieldsByQuery.issueid
                iscontext: true
              right:
                value:
                  simple: BP-V-10
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 9b7a0027-fb01-4ec2-8e08-01d4ea79a4c1
    type: playbook
    task:
      id: 9b7a0027-fb01-4ec2-8e08-01d4ea79a4c1
      version: -1
      name: PAN-OS Network Operation - Run Bulk Change
      description: This playbook runs the fixes identified by GroupIssuesByFields
        as a looped playbook to ensure the correct objects are updated at all times.
      playbookName: PAN-OS Network Operations - Run Bulk Change
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      attribute_to_update:
        simple: group
      issue_to_fix:
        simple: ${bpv10fixes}
      new_value:
        simple: ${inputs.default_security_profile_group}
      object_type:
        simple: SecurityRule
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
      forEach: true
    view: |-
      {
        "position": {
          "x": -450,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: df421c62-91e5-4424-82ec-f108081dd223
    type: regular
    task:
      id: df421c62-91e5-4424-82ec-f108081dd223
      version: -1
      name: Get Security Profile Groups
      description: Searches and returns a reference for the given object type and
        name. If no name is provided, all objects of the given type will be returned.
        Note this ONLY returns the object name and its location in the configuration
        hierachy, not the entire object.
      script: '|||pan-os-config-get-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      device_filter_string:
        simple: ${GetIndicatorFieldsByQuery.issueaffecteddevice}
      object_type:
        simple: SecurityProfileGroup
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -710,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: a856436e-4a8e-4804-8e89-23baf51e4bac
    type: condition
    task:
      id: a856436e-4a8e-4804-8e89-23baf51e4bac
      version: -1
      name: Do we have a default Security Profile Group
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.default_security_profile_group
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 6b5629be-9b56-485b-816e-646dce97dc0c
    type: collection
    task:
      id: 6b5629be-9b56-485b-816e-646dce97dc0c
      version: -1
      name: Select the Security Profile Group to use.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -710,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body: null
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          complex:
            root: PANOS.PanosObject
            accessor: name
            transformers:
            - operator: concat
              args:
                prefix:
                  value:
                    simple: |+
                      ### Enter the security profile group to use for the rules. The existing security profile groups are;

                suffix: {}
            - operator: join
              args:
                separator:
                  value:
                    simple: ', '
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: defaultsecurityprofilegroup
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Log Forwarding Profile Selection
      description: |-
        To rectify BP-V-10 issues - a missing security profile group - you must choose security profile group to set on the rule.

        **A default  value can be provided in the playbook inputs to avoid this question in the future.**
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: c1724e92-29ce-4248-8e21-5ee8c60e113b
    type: title
    task:
      id: c1724e92-29ce-4248-8e21-5ee8c60e113b
      version: -1
      name: BP-V-9
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: bf71a9f6-8b10-4514-8e9b-91fca191bd75
    type: title
    task:
      id: bf71a9f6-8b10-4514-8e9b-91fca191bd75
      version: -1
      name: BP-V-7
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: d61cbe04-bdd0-4bf3-8c61-ac6ba8d3e974
    type: condition
    task:
      id: d61cbe04-bdd0-4bf3-8c61-ac6ba8d3e974
      version: -1
      name: Do we have BP-V-7 issues?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GetIndicatorFieldsByQuery.issueid
            iscontext: true
          right:
            value:
              simple: BP-V-7
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: ec555b06-cc0a-4188-8810-44ee448f5fc1
    type: regular
    task:
      id: ec555b06-cc0a-4188-8810-44ee448f5fc1
      version: -1
      name: Group
      description: Groups configuration issues into actionable items so they can be
        passed into the `pan-os-config-bulk-update` command.
      scriptName: GroupIssuesByFields
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      extend-context:
        simple: bpv7fixes=.
      indicator_fields_by_query:
        complex:
          root: GetIndicatorFieldsByQuery
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GetIndicatorFieldsByQuery.issueid
                iscontext: true
              right:
                value:
                  simple: BP-V-7
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 2a40c656-9d14-44ca-8066-d5648519e77a
    type: regular
    task:
      id: 2a40c656-9d14-44ca-8066-d5648519e77a
      version: -1
      name: Get Log Forwarding Profiles
      description: Searches and returns a reference for the given object type and
        name. If no name is provided, all objects of the given type will be returned.
        Note this ONLY returns the object name and its location in the configuration
        hierachy, not the entire object.
      script: '|||pan-os-config-get-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      device_filter_string:
        simple: ${GetIndicatorFieldsByQuery.issueaffecteddevice}
      object_type:
        simple: LogForwardingProfile
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: bf8aecca-bc0e-44fe-8aaa-074d24422370
    type: condition
    task:
      id: bf8aecca-bc0e-44fe-8aaa-074d24422370
      version: -1
      name: Do we have a default log forwarding profile?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.default_log_forwarding_profile
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: d4bb6c77-e603-4c3e-828d-43ce57730444
    type: collection
    task:
      id: d4bb6c77-e603-4c3e-828d-43ce57730444
      version: -1
      name: Select the log Forwarding profile to use.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body: null
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          complex:
            root: PANOS.PanosObject
            accessor: name
            transformers:
            - operator: concat
              args:
                prefix:
                  value:
                    simple: |+
                      #### Set the default log forwarding profile.

                      *The Log Forwarding profiles configured in Panorama are listed below*



                suffix: {}
            - operator: join
              args:
                separator:
                  value:
                    simple: ', '
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: defaultlogforwardingprofile
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Log Forwarding Profile Selection
      description: |-
        To rectify BP-V-7 issues - missing log forwarding setting - you must choose which log forwarding profile to set.

        **A default  value can be provided in the playbook inputs to avoid this question in the future.**
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 5631f83e-8b48-48b1-87ca-db249f9f4453
    type: playbook
    task:
      id: 5631f83e-8b48-48b1-87ca-db249f9f4453
      version: -1
      name: PAN-OS Network Operation - Run Bulk Change
      description: This playbook runs the fixes identified by GroupIssuesByFields
        as a looped playbook to ensure the correct objects are updated at all times.
      playbookName: PAN-OS Network Operations - Run Bulk Change
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      attribute_to_update:
        simple: log_setting
      issue_to_fix:
        simple: ${bpv7fixes}
      new_value:
        simple: ${inputs.default_log_forwarding_profile}
      object_type:
        simple: SecurityZone
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
      forEach: true
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 76156221-6199-4647-8e1c-3c3ff5ba6d62
    type: title
    task:
      id: 76156221-6199-4647-8e1c-3c3ff5ba6d62
      version: -1
      name: No Issues.
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -870,
          "y": 975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2805,
        "width": 2700,
        "x": -870,
        "y": 20
      }
    }
  }
inputs:
- key: issue_query
  value:
    simple: ${incident.issuequery}
  required: true
  description: The TIM query to filter for issues.
  playbookInputQuery: null
- key: default_log_forwarding_profile
  value:
    simple: ${incident.defaultlogforwardingprofile}
  required: false
  description: If present, will be used whenever log forwarding needs to be enabled.
  playbookInputQuery: null
- key: default_security_profile_group
  value:
    simple: ${incident.defaultsecurityprofilegroup}
  required: false
  description: If present, will be used whenever a security profile group needs to
    be set.
  playbookInputQuery: null
outputs: []
