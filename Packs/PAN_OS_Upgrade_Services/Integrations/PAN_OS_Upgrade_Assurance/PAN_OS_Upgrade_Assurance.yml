category: Utilities
commonfields:
  id: PAN_OS_Upgrade_Assurance
  version: -1
configuration:
- defaultvalue: 192.168.1.1
  display: Panorama IP or Hostname
  name: url
  required: true
  type: 0
- display: Panorama Username
  name: panorama_user
  required: true
  type: 0
- display: Panorama Password
  name: panorama_password
  required: true
  type: 4
- display: Server Port
  name: port
  required: false
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Operational testing for PAN-OS for PAN-OS upgrades.
display: PAN-OS Assurance Testing
fromversion: 6.0.0
name: PAN_OS_Upgrade_Assurance
script:
  commands:
  - arguments:
    - default: false
      description: The firewall serial number to run validations against. Use `pan-os-platform-get-system-info if not known`.
      isArray: false
      name: firewall_serial
      required: true
      secret: false
    - default: false
      description: List of tests to run. If not provided, a base set of tests will be run.
      isArray: true
      name: check_list
      required: false
      secret: false
    - default: false
      description: The minimum content version to check for, enables "content_version" check
      isArray: false
      name: min_content_version
      required: false
      secret: false
    - default: false
      description: The candidate version to runchecks against. Enables "free_disk_space" check
      isArray: false
      name: candidate_version
      required: false
      secret: false
    - default: false
      description: The drift allowed between DP clock and MP clock. Enabled "planes_clock_sync" check.
      isArray: false
      name: dp_mp_clock_diff
      required: false
      secret: false
    - default: false
      description: Check a specific IPsec - by tunnel name. Tunnel must be up for this check to pass.
      isArray: false
      name: ipsec_tunnel_status
      required: false
      secret: false
    - default: false
      description: Check for the existence of a specific IP in the ARP Table.
      isArray: false
      name: arp_entry_exists
      required: false
      secret: false
    - default: false
      description: |
        Check for the presence of a specific connection. Session check format is <source>/destination/destination-port. example: 10.10.10.10/8.8.8.8/443
      isArray: false
      name: check_session_exists
      required: false
      secret: false
    deprecated: false
    description: "Runs checks to confirm a PAN-OS firewall is ready to be upgraded."
    name: pan-os-assurance-run-readiness-checks    
    outputs:
      - contextPath: FirewallAssurance.ReadinessCheckResults
        description: Readiness check results
        type: Unknown
  - arguments:
      - default: false
        description: The firewall serial number to run validations against. Use `pan-os-platform-get-system-info if not known`.
        isArray: false
        name: firewall_serial
        required: true
        secret: false
      - default: true
        description: The name of the snapshot to take. Defaults to "fw_snapshot"
        isArray: false
        name: snapshot_name
        required: false
        secret: false
      - default: false
        description: List of tests to run. If not provided, a base set of tests will be run.
        isArray: true
        name: check_list
        required: false
        secret: false
    deprecated: false
    description: "Takes a snapshot of the operational state of the system."
    name: pan-os-assurance-run-snapshot    
    outputs:
      - contextPath: File.EntryID
        description: The EntryID of the report file.
        type: Unknown
      - contextPath: File.Extension
        description: The extension of the report file.
        type: String
      - contextPath: File.Name
        description: The name of the report file.
        type: String
      - contextPath: File.Info
        description: The info of the report file.
        type: String
      - contextPath: File.Size
        description: The size of the report file.
        type: Number
      - contextPath: File.Type
        description: The type of the report file.
        type: String
  - arguments:
      - default: false
        description: The Left (or "first") snapshot to compare.
        isArray: false
        name: left_snapshot_id
        required: true
        secret: false
      - default: false
        description: The right (or "second") snapshot to compare.
        isArray: false
        name: right_snapshot_id
        required: true
        secret: false
    deprecated: false
    description: "Takes a snapshot of the operational state of the system."
    name: pan-os-assurance-compare-snapshots    
    outputs:
      - contextPath: FirewallAssurance.SnapshotComparisonResult
        description: Snapshot comparison results
        type: Unknown
      - contextPath: FirewallAssurance.SnapshotComparisonRawResult
        description: The complete snapshot comparison results
        type: Unknown
  dockerimage: ghcr.io/paloaltonetworks/panos_upgrade_assurance:latest
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests
